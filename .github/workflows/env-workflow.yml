name: Global ENV Variable

on: [push]
# ðŸŒŽ WORKFLOW LEVEL ENVIRONMENT VARIABLE
# This variable is available everywhere in this entire workflow file.
env:
  PROJECT_VERSION: 'v2.5.1-beta'
  ENVIRONMENT_TYPE: 'staging'
  
jobs:
  # 1. BUILD JOB
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Report Build Version
        run: |
          echo "Building package for version: ${{ env.PROJECT_VERSION }}"
          echo "Configuration target: ${{ env.ENVIRONMENT_TYPE }}"
          echo "Building package..."

  # 2. TEST JOB
  test:
    runs-on: ubuntu-latest
    needs: [build] # Ensures build runs first
    steps:
      - name: Run Tests
        run: |
          echo "--- Starting Tests ---"
          # The variable is automatically available here too.
          echo "Testing against code base: ${{ env.PROJECT_VERSION }}"
          echo "Running unit tests for ${{ env.ENVIRONMENT_TYPE }} environment..."
          # Simulate setting up test environment using the variable
          ./setup-test-env --version ${{ env.PROJECT_VERSION }}

  # 3. DEPLOY JOB
  deploy:
    runs-on: ubuntu-latest
    needs: [test] # Ensures test runs first
    
    steps:
      - name: Deploy to Target Environment
        run: |
          echo "--- Deployment Started ---"
          # The variable is available again for deployment logic.
          echo "Deploying ${{ env.PROJECT_VERSION }} to ${{ env.ENVIRONMENT_TYPE }}..."
          # Command example
          ./deploy-script --target ${{ env.ENVIRONMENT_TYPE }} --version ${{ env.PROJECT_VERSION }}
          echo "Deployment successful."